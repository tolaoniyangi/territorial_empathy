<!DOCTYPE html>
<html lang="en">
    <meta charset="utf-8">

    <head>
        <title> COVID Deaths </title>

        <!-- Google fonts code -->
            <link href="https://fonts.googleapis.com/css?family=Dosis|Poppins|Abel|Roboto" rel="stylesheet">

        <!-- Load d3.js to read csv, charts.js to make chart, jquery -->
        <script src='https://d3js.org/d3.v5.min.js' charset='utf-8'></script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"> </script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        
        <!-- <script src="js/animation.js"></script> -->
        <link rel="stylesheet" type="text/css" href="css/style.css">

    </head>

    <body>
        <!-- <div id="title">How did COVID affect different races?</div> -->
        <div id="legend">
            <!-- <div class="item infections">Infections</div>
            <div class="item hospitalizations">Hospitalizations</div>
            <div class="item deaths">Deaths</div> -->
        </div>
        <div id="chart-wrapper">
            <canvas id="chart" width="800" height="600"></canvas>
        </div>
        <div id="footer">
            <!-- <div class="left" ><a href="https://createwithdata.com/chartjs-and-csv/" target="_blank">About</a></div>
            <div class="right">Source: <a href="https://public.tableau.com/en-us/s/resources" target="_blank">Tableau</a> / Wikipedia</div> -->
        </div>
   </body>

    <script type="text/javascript">
        Chart.defaults.global.defaultFontFamily = 'Roboto';
        Chart.defaults.global.defaultFontColor = '#333';
        Chart.defaults.global.defaultFontStyle = 'italic';
        // Chart.defaults.global.defaultFontSize = '24';

        function makeChart(covidByRace) {
            var raceLabels = covidByRace.map(function(d) {return d.RACE_GROUP});
            var infectedData = covidByRace.map(function(d) {return +d.CASE_RATE_ADJ});
            var hospitalizedData = covidByRace.map(function(d) {return +d.HOSPITALIZED_RATE_ADJ});
            var diedData = covidByRace.map(function(d) {return +d.DEATH_RATE_ADJ});
            // var raceColors = covidByRace.map(function(d) {return d.RACE_GROUP === 'Asian/Pacific-Islander' ? '#F15F36' : '#19A0AA';});

            var chart = new Chart('chart', {
                type: 'radar',
                options: {
                    responsive:true,
                    maintainAspectRatio: true,
                    legend: {
                        display: true,
                        labels:{
                            fontColor: 'black',
                            // defaultFontFamily: 'Roboto',
                        },
                    },
                    title: {
                        display: true,
                        text: 'How did COVID affect different races?',
                        fontSize: 24,
                        padding: 12,
                    },
                    scale: {
                        pointLabels :{
                            fontStyle: "bold",
                            fontFamily:'Roboto',
                            fontSize: '14',
                        },
                    },
                    tooltips: {
                        enabled: true,
                        callbacks: {
                            label: function(tooltipItem, data) {
                                return data.datasets[tooltipItem.datasetIndex].label + ' : ' + data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index];
                            }
                        }
                    },
                },
                data: {
                    labels: raceLabels,
                    datasets: [
                        {
                            data: infectedData,
                            label: "Infections",
                            fill: true,
                            backgroundColor: 'rgba(25,160,170,.3)',
                            borderColor: 'rgba(25,160,170,1)',
                            pointBorderColor: "#fff",
                            pointBackgroundColor: "rgba(25,160,170,1)",
                        }, {
                            data: hospitalizedData,
                            label: "Hospitalizations",
                            backgroundColor: 'rgba(241,95,54,.3)',
                            borderColor: 'rgba(241,95,54,1)',
                            pointBorderColor: "#fff",
                            pointBackgroundColor: "rgba(241,95,54,1)",
                            // backgroundColor: playerColors
                        }, {
                            data: diedData,
                            label: "Deaths",
                            backgroundColor: 'rgba(93,3,105,.3)',
                            borderColor: 'rgba(93,3,105,1)',
                            pointBorderColor: "#fff",
                            pointBackgroundColor: "rgba(93,3,105,1)",
                            // backgroundColor: playerColors
                        }
                    ]
                }
            })
        }

        // Request data using D3
        d3.csv('https://raw.githubusercontent.com/nychealth/coronavirus-data/3f21405a00bf7c93db5a5209b44886882feb30a6/by-race.csv')
        // d3.csv('https://s3-us-west-2.amazonaws.com/s.cdpn.io/2814973/atp_wta.csv')
            .then(makeChart);

    </script> 

</html>

